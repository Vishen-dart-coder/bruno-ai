<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Bruno AI – Offline (All-in-One HTML)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#000;--panel:#454545;--box:#2b2b2b;--user:#376da2;--bot:#1b1e1c;--text:#fff;--muted:#aaa;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;padding:0;background:var(--bg);color:var(--text);
      font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      display:flex;align-items:center;justify-content:center;
    }
    .wrap{
      width:min(1000px,92vw); background:var(--panel); border-radius:20px; padding:20px;
      box-shadow:0 0 24px rgba(255,255,255,.2); display:flex; flex-direction:column; gap:12px;
    }
    header{display:flex; align-items:center; justify-content:space-between;}
    header h1{font-size:18px; margin:0; opacity:.9}
    .actions{display:flex; gap:8px}
    button{
      border:none; border-radius:20px; padding:10px 16px; cursor:pointer; color:#fff;
      background:var(--user); transition:.2s ease; font-weight:600;
    }
    button:hover{filter:brightness(.9)}
    .danger{background:#e04646}
    .chat{
      height:min(60vh,560px); background:var(--box); border-radius:12px; padding:14px;
      overflow:auto; display:flex; flex-direction:column; gap:8px; border:1px solid #444;
    }
    .msg{
      max-width:72%; padding:12px 16px; border-radius:18px; word-wrap:break-word;
      opacity:0; animation:fade .35s forwards;
    }
    .me{margin-left:auto; background:var(--user); color:#fff; text-align:right}
    .bot{margin-right:auto; background:var(--bot); color:#fff; text-align:left}
    .typing{color:var(--muted); font-style:italic; padding:6px 10px}
    @keyframes fade{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)}}
    .input{
      display:flex; gap:8px;
    }
    .input input{
      flex:1; padding:12px 14px; border-radius:20px; border:none; outline:none; font-size:16px;
    }
    .hint{opacity:.6; font-size:12px}
    .pillbar{display:flex; gap:6px; flex-wrap:wrap}
    .pill{
      background:#343a40; color:#e7e7e7; border:1px solid #4a4a4a; border-radius:999px;
      padding:6px 10px; font-size:12px; cursor:pointer;
    }
    .pill:hover{filter:brightness(1.2)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Bruno AI</h1>
      <div class="actions">
        <button onclick="seedGreeting()">Seed Greeting</button>
        <button class="danger" onclick="clearAll()">Clear Chat & Memory</button>
      </div>
    </header>

    <div class="pillbar">
      <span class="pill" onclick="quick('My name is Alex')">Set name</span>
      <span class="pill" onclick="quick('area of circle')">Math</span>
      <span class="pill" onclick="quick('python loop')">Python</span>
      <span class="pill" onclick="quick('capital of france')">Geography</span>
      <span class="pill" onclick="quick('tell me a joke')">Joke</span>
      <span class="pill" onclick="quick('12*(5+3)-4')">Calculator</span>
      <span class="pill" onclick="quick('and usa?')">Follow-up</span>
    </div>

    <div id="chat" class="chat"></div>

    <div class="input">
      <input id="box" type="text" placeholder="Type here…  (e.g., My name is Sam • area of circle • python list • 12*(5+3))" onkeydown="if(event.key==='Enter') send()">
      <button onclick="send()">Send</button>
    </div>
    <div class="hint">Pro tip: say <em>“My name is …”</em>. Ask something, then follow with <em>“and …?”</em> to use context.</div>
  </div>

  <!-- ALL THE JS IS EMBEDDED *INSIDE THIS HTML* -->
  <script>
    // ===== Memory (stored in RAM only; cleared on refresh) =====
    let memory = { name: null, lastTopic: null, lastSubject: null };

    // ===== Knowledge base (expand freely) =====
    // Organize by categories; each entry = "trigger phrase": "answer"
    const KB = {
      greetings: {
        "hello":"Hey there 👋! I'm Bruno, your offline buddy.",
        "hi":"Hi! How can I help?",
        "good morning":"Good morning ☀️ Let’s make today awesome!",
        "good night":"Good night 🌙 Sweet dreams!",
        "how are you":"Running great ⚡ thanks for asking!",
        "your name":"I’m Bruno AI 🤖 (offline).",
        "who made you":"I was Made by Vishen Sharma and a bit of help from Google"
      },

      math: {
        "pi":"π ≈ 3.14159",
        "euler number":"Euler’s number e ≈ 2.71828",
        "golden ratio":"φ ≈ 1.61803",
        "area of circle":"Area = π × r²",
        "circumference of circle":"C = 2πr",
        "perimeter of square":"Perimeter = 4 × side",
        "area of triangle":"Area = ½ × base × height",
        "pythagoras":"a² + b² = c²",
        "quadratic formula":"x = [-b ± √(b² − 4ac)] / (2a)",
        "sine 90":"sin(90°) = 1",
        "cos 0":"cos(0°) = 1",
        "tan 45":"tan(45°) = 1",
        "log rules":"log(ab)=log a + log b;  log(a/b)=log a − log b;  log(a^k)=k·log a",
        "derivative of x^2":"d/dx (x²) = 2x",
        "integral of x":"∫ x dx = x²/2 + C",
        "distance formula":"d = √[(x₂−x₁)² + (y₂−y₁)²]",
        "simple interest":"SI = (P·R·T)/100",
        "compound interest":"A = P(1 + r/n)^(n·t)"
      },

      science: {
        "speed of light":"c ≈ 299,792 km/s ⚡",
        "earth radius":"≈ 6,371 km 🌍",
        "gravity on earth":"g ≈ 9.8 m/s²",
        "h2o":"H₂O is water 💧",
        "oxygen symbol":"O",
        "dna":"DNA = Deoxyribonucleic Acid 🧬",
        "photosynthesis":"6CO₂ + 6H₂O → C₆H₁₂O₆ + 6O₂ (in plants 🌿)",
        "newton":"Isaac Newton formulated the laws of motion & gravity.",
        "einstein":"Albert Einstein developed relativity.",
        "planck constant":"6.626×10⁻³⁴ J·s",
        "mercury":"Closest planet to the Sun 🌞",
        "venus":"Hottest planet 🔥 (thick CO₂ atmosphere)",
        "mars":"The Red Planet 🔴",
        "jupiter":"Largest planet; Great Red Spot 🌪",
        "saturn":"Rings made of ice & rock 💍",
        "moon landing":"First human landing: 1969 (Apollo 11) 🌕"
      },

      history: {
        "who discovered america":"Christopher Columbus (1492).",
        "world war 1":"1914–1918.",
        "world war 2":"1939–1945.",
        "independence of india":"15 August 1947 🇮🇳.",
        "roman empire":"27 BC – 476 AD.",
        "cold war":"USA vs USSR tensions, ~1947–1991.",
        "printing press":"Invented by Gutenberg, ~1440.",
        "telephone invention":"Alexander Graham Bell, 1876."
      },

      geography: {
        "capital of india":"New Delhi 🇮🇳",
        "capital of usa":"Washington, D.C. 🇺🇸",
        "capital of france":"Paris 🇫🇷",
        "largest ocean":"Pacific Ocean 🌊",
        "largest country":"Russia (by land area).",
        "smallest country":"Vatican City.",
        "mount everest":"Tallest mountain: 8,849 m 🏔️",
        "sahara desert":"Largest hot desert 🏜️",
        "river nile":"Often cited as the longest river."
      },

      languages_culture: {
        "days of week":"Mon, Tue, Wed, Thu, Fri, Sat, Sun.",
        "months":"Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec.",
        "hello in french":"Bonjour",
        "hello in spanish":"Hola",
        "currency of japan":"Yen (JPY) ¥"
      },

      coding_basics: {
        // HTML / CSS
        "html":"<!DOCTYPE html><html><head><title>Page</title></head><body><h1>Hello!</h1></body></html>",
        "html form":"<form><input type='text' placeholder='Name'><button>Send</button></form>",
        "html table":"<table border='1'><tr><th>Name</th><th>Age</th></tr><tr><td>Ana</td><td>12</td></tr></table>",
        "css":"body{background:#000;color:#fff;font-family:sans-serif}",
        "css flexbox":".container{display:flex;justify-content:center;align-items:center}",
        "css grid":".grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}",

        // JavaScript
        "javascript loop":"for(let i=0;i<5;i++){console.log(i)}",
        "javascript array":"const fruits=['apple','banana']; console.log(fruits[0])",
        "javascript function":"function greet(name){return 'Hello '+name}",
        "javascript class":"class Dog{constructor(name){this.name=name}}",

        // Python
        "python loop":"for i in range(5): print(i)",
        "python list":"nums=[1,2,3]; print(nums[0])",
        "python function":"def greet(name): return 'Hello '+name",
        "python class":"class Dog:\n  def __init__(self,name):\n    self.name=name",

        // Java
        "java hello":"class Hello{public static void main(String[]a){System.out.println(\"Hello\");}}",
        "java array":"int[] a={1,2,3}; System.out.println(a[0]);",

        // C++
        "c++ hello":"#include <iostream>\nusing namespace std;\nint main(){cout<<\"Hello\";}",
        "c++ array":"int a[3]={1,2,3}; cout<<a[0];",

        // SQL / C# / PHP
        "sql select":"SELECT * FROM students WHERE age>15;",
        "sql create table":"CREATE TABLE users(id INT, name VARCHAR(40));",
        "c# hello":"Console.WriteLine(\"Hello World\");",
        "php hello":"<?php echo 'Hello World'; ?>"
      },

      dsa_ai: {
        "big o":"O(1) constant, O(log n) logarithmic, O(n) linear, O(n log n) etc.",
        "stack":"Stack = LIFO (Last In, First Out) 📚",
        "queue":"Queue = FIFO (First In, First Out) 🚶",
        "binary search":"Search a sorted array by halving each step.",
        "hash map":"Key → value structure with average O(1) access.",
        "ai":"AI = tasks requiring human-like intelligence by machines.",
        "ml":"ML = models learn patterns from data."
      },

      fun_trivia: {
        "joke":"Why did the programmer quit his job? He didn’t get arrays 😅.",
        "joke 2":"I told a joke about UDP… I’m not sure if anyone got it.",
        "riddle":"I speak without a mouth and hear without ears. What am I? (An echo)",
        "riddle 2":"Tall when young, short when old. (A candle)",
        "fact":"Honey never spoils 🍯.",
        "fact 2":"Octopuses have three hearts 🐙.",
        "quote":"“The best way to predict the future is to invent it.” — Alan Kay"
      }
    };

    // ===== Helpers =====
    const chat = document.getElementById('chat');
    const box  = document.getElementById('box');

    function quick(text){ box.value = text; send(); }
    function seedGreeting(){
      addMsg("Hi Bruno!", "me");
      respond("Hi " + (memory.name || "there") + " 👋 Ask me anything!");
    }

    function addMsg(text, who="bot"){
      const div = document.createElement('div');
      div.className = `msg ${who==='me'?'me':'bot'}`;
      div.textContent = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    function addTyping(){
      const t = document.createElement('div');
      t.className = 'typing';
      t.id = 'typing';
      t.textContent = 'Bruno is typing…';
      chat.appendChild(t);
      chat.scrollTop = chat.scrollHeight;
    }
    function removeTyping(){
      const t = document.getElementById('typing');
      if(t) t.remove();
    }

    function send(){
      const raw = box.value.trim();
      if(!raw) return;
      addMsg(raw, "me");
      box.value = "";
      addTyping();
      setTimeout(()=>{ removeTyping(); respond(raw); }, 650);
    }

    function respond(raw){
      let input = raw.toLowerCase();

      // ===== Name memory =====
      if(input.startsWith("my name is")){
        memory.name = input.replace("my name is","").trim();
        addMsg(`Nice to meet you, ${capitalize(memory.name)}! I’ll remember your name. 😊`);
        return;
      }
      if(input.includes("what is my name")){
        addMsg(memory.name ? `Your name is ${capitalize(memory.name)} 😎` : `I don’t know yet — say “My name is …”`);
        return;
      }

      // ===== Contextual follow-ups: "and …?" =====
      if(input.startsWith("and ") && (memory.lastTopic || memory.lastSubject)){
        input = `${memory.lastTopic || ""} ${memory.lastSubject || ""} ${input.replace(/^and\s+/, "")}`.trim();
      }

      // ===== Exact / contains matches in KB =====
      const hit = lookupKB(input);
      if(hit){
        // Save some lightweight context
        memory.lastTopic = hit.topic;      // eg "capital"
        memory.lastSubject = hit.subject;  // eg "india"
        addMsg(hit.answer);
        return;
      }

      // ===== Calculator (very basic) =====
      if(/^[0-9\.\s\+\-\*\/\%\(\)]+$/.test(input)){
        try{
          // eslint-disable-next-line no-eval
          const out = eval(input);
          addMsg(`Answer: ${out}`);
        }catch(e){
          addMsg("That math looks tricky 😅");
        }
        return;
      }

      // ===== Fuzzy (keyword) suggestion =====
      const guess = fuzzyGuess(input);
      if(guess){
        addMsg(`Maybe you meant: “${guess.key}” → ${guess.answer}`);
        memory.lastTopic = guess.topic;
        memory.lastSubject = guess.subject;
        return;
      }

      // ===== Fallback =====
      addMsg("Hmm 🤔 I don’t know that yet. Try **Math, Science, History, Geography, Coding, DSA/AI, or Fun facts**. You can also type math like `12*(5+3)`.");
    }

    // Try to find a response; also parse a simple (topic, subject)
    function lookupKB(input){
      // direct contains
      for(const category in KB){
        for(const key in KB[category]){
          if(input.includes(key)){
            const {topic, subject} = parseTopicSubject(key);
            return { answer: KB[category][key], topic, subject };
          }
        }
      }
      // smarter: detect patterns like "capital of X"
      if(input.startsWith("capital of ")){
        const place = input.replace("capital of ","").trim();
        const map = {
          "india":"capital of india",
          "usa":"capital of usa",
          "united states":"capital of usa",
          "france":"capital of france"
        };
        const key = map[place];
        if(key){
          const {topic, subject} = parseTopicSubject(key);
          return { answer: findKB(key), topic, subject };
        }
      }
      return null;
    }

    function parseTopicSubject(key){
      // very lightweight heuristic (good enough offline)
      // e.g., "capital of india" → topic="capital", subject="india"
      let topic = key.split(" ")[0];
      let subject = key.includes(" of ") ? key.split(" of ").pop() : key.split(" ").pop();
      return {topic, subject};
    }

    function findKB(key){
      for(const c in KB){ if(KB[c][key]) return KB[c][key]; }
      return null;
    }

    // fuzzy Jaccard-ish
    function fuzzyGuess(input){
      let best = {score:0, key:null, answer:null, topic:null, subject:null};
      const A = new Set(cleanTokens(input));
      for(const cat in KB){
        for(const key in KB[cat]){
          const B = new Set(cleanTokens(key));
          const inter = [...A].filter(x=>B.has(x)).length;
          const union = new Set([...A, ...B]).size || 1;
          const score = inter/union;
          if(score>best.score){
            const {topic, subject} = parseTopicSubject(key);
            best = {score, key, answer:KB[cat][key], topic, subject};
          }
        }
      }
      return best.score>=0.42 ? best : null;
    }

    function cleanTokens(s){
      return s.replace(/[^a-z0-9\s]/g," ").split(/\s+/).filter(Boolean);
    }

    function capitalize(s){ return (s||"").replace(/\b\w/g, m=>m.toUpperCase()); }

    // UI helpers
    function clearAll(){
      chat.innerHTML = "";
      memory = { name:null, lastTopic:null, lastSubject:null };
      addMsg("Chat cleared. Memory reset 🧹");
    }

    // Initial welcome
    (function init(){
      addMsg("Hello! I’m Bruno (offline). Tell me your name, ask about math/science/history/geography/coding/DSA/AI, or type calculations. Try: “capital of india”, “python loop”, or “12*(5+3)”.");
    })();
  </script>
</body>
</html>
